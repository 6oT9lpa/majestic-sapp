<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Majestic | Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', path='fonts/fontawesome/css/all.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='fonts/roboto/roboto.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/root.css?v=0.0.4') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/dashboard.css?v=0.0.13') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/modal.css?v=0.0.4') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/tooltip.css?v=0.0.4') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/navbar.css?v=0.0.5') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/messanger.css?v=0.0.12') }}">
    <link rel="stylesheet" href="{{ url_for('static', path='styles/admin-dashboard.css?v=0.0.15') }}">
</head>
<body>
    <div class="dashboard-container">
        <!-- Верхняя панель с вкладками -->
        <div class="dashboard-header">
            <div class="dashboard-tabs">
                <div class="dropdown">
                    <button class="dropdown-btn btn active" id="appeals-dropdown">
                        Обращения
                        <svg class="dropdown-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <div class="dropdown-content">
                        <button class="dropdown-item active" data-tab="appeals-active">Активные обращения</button>
                        <button class="dropdown-item" data-tab="appeals-closed">Закрытые обращения</button>
                    </div>
                </div>
                {% if user["role"] and user["role"]["level"] >= 4 %}
                    <button class="tab-btn" data-tab="deleted-accounts">Удаленные аккаунты</button>
                {% endif %}

                {% if user["role"] and user["role"]["level"] >= 5 %}
                    <button class="tab-btn" onclick="window.location.href='/dashboard/admin/reports'">Отчетность</button>
                {% endif %}

                {% if user["role"] and user["role"]["level"] >= 6 %}
                    <button class="tab-btn" onclick="window.location.href='/dashboard/admin/general'">Управление</button>
                {% endif %}
                
                <div class="tab-indicator"></div>
            </div>
            <div class="group-header dashboard-tabs">
                <div class="tooltip-container">
                    <button class='nav-btn btn theme-toggle' aria-label="Переключить тему">
                        <!-- Иконка солнца -->
                        <svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                        </svg>
                        <!-- Иконка луны -->
                        <svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                    <span class="tooltip-text">Сменить тему</span>
                </div> 
                <div class="tooltip-container">
                    <button class="nav-btn" onclick="window.location.href='/dashboard/'">
                        <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g clip-path="url(#clip0_429_11067)"> <path d="M15 4.00098H5V18.001C5 19.1055 5.89543 20.001 7 20.001H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M16 15.001L19 12.001M19 12.001L16 9.00098M19 12.001H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g> <defs> <clipPath id="clip0_429_11067"> <rect width="24" height="24" fill="currentColor" transform="translate(0 0.000976562)"></rect> </clipPath> </defs> </g></svg>
                    </button>
                    <span class="tooltip-text">Вернуться назад</span>
                </div>
            </div>  
        </div>

        <div class="dashboard-content">
            <!-- Вкладка активных обращений -->
            <div class="tab-content active" id="appeals-active-tab">
                <div class="appeals-container">
                    <div class="appeals-header">
                        <h2>Активные обращения</h2>
                        <div class="header-actions">
                            <div class="search-box">
                                <input type="text" placeholder="Поиск по ID или тексту..." id="search-input">
                                <button class="search-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <div class="dropdown">
                                <button class="filter-btn">
                                    <svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19 3H5C3.89543 3 3 3.89543 3 5V6.17157C3 6.70201 3.21071 7.21071 3.58579 7.58579L9.41421 13.4142C9.78929 13.7893 10 14.298 10 14.8284V20V20.2857C10 20.9183 10.7649 21.2351 11.2122 20.7878L12 20L13.4142 18.5858C13.7893 18.2107 14 17.702 14 17.1716V14.8284C14 14.298 14.2107 13.7893 14.5858 13.4142L20.4142 7.58579C20.7893 7.21071 21 6.70201 21 6.17157V5C21 3.89543 20.1046 3 19 3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                    </svg>
                                    Фильтры
                                </button>
                                <div class="dropdown-content filters-dropdown">
                                    <div class="filter-group">
                                        <label class="filter-label">Тип обращения</label>
                                        <select class="filter-select" id="type-filter">
                                            <option value="all">Все типы</option>
                                            <option value="help">Помощь</option>
                                            <option value="complaint">Жалоба</option>
                                            <option value="amnesty">Амнистия</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label class="filter-label">Статус</label>
                                        <select class="filter-select" id="status-filter">
                                            <option value="all">Все статусы</option>
                                            <option value="pending">Ожидает</option>
                                            <option value="in_progress">В работе</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label class="filter-checkbox-label">
                                            <input type="checkbox" id="assigned-to-me" class="filter-checkbox">
                                            Только мои обращения
                                        </label>
                                    </div>
                                    <button class="apply-filters-btn">
                                        Применить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="appeals-list">
                        <!-- Сюда будут загружаться обращения через JS -->
                        <div class="loading-row">
                            <i class="fas fa-spinner fa-spin"></i> Загрузка обращений...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Вкладка завершенных обращений -->
            <div class="tab-content" id="appeals-closed-tab">
                <div class="appeals-container">
                    <div class="appeals-header">
                        <h2>Завершенные обращения</h2>
                        <div class="header-actions">
                            <div class="search-box">
                                <input type="text" placeholder="Поиск по ID или тексту..." id="search-input">
                                <button class="search-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="appeals-list">
                        <!-- Сюда будут загружаться обращения через JS -->
                        <div class="loading-row">
                            <i class="fas fa-spinner fa-spin"></i> Загрузка обращений...
                        </div>
                    </div>
                </div>
            </div>

            <!-- Вкладка учета удаленных аккаунтов -->  
            <div class="tab-content" id="deleted-accounts-tab">
                <div class="appeals-container">
                    <div class="appeals-header">
                        <h2>Учет удаленных аккаунтов</h2>
                        <div class="header-actions">
                            <button class="primary-btn" id="add-deleted-account-btn">
                                <i class="fas fa-plus"></i> Добавить
                            </button>
                        </div>
                    </div>
                    <div class="appeals-list" id="deleted-accounts-list">
                        <div class="loading-row">
                            <i class="fas fa-spinner fa-spin"></i> Загрузка данных...
                        </div>
                    </div>
                </div>
            </div>

            {% include "appeal/appeal_chat.html" %}
        </div>
    </div>

    <!-- Модальное окно для добавления удаленных аккаунтов -->
    <div class="modal hidden" id="add-deleted-account-modal" style=" display: none;">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Добавить удаленные аккаунты</h2>
            
            <div class="form-group">
                <label for="main-account-url">Ссылка на основной аккаунт:</label>
                <input type="text" id="main-account-url" placeholder="https://forum.majestic-rp.ru/members/username.123456/">
            </div>
            
            <div class="form-group">
                <label>Ссылки на удаляемые аккаунты:</label>
                <div id="deleted-accounts-container">
                    <div class="deleted-account-input">
                        <input type="text" class="account-url" placeholder="https://forum.majestic-rp.ru/members/username.123456/">
                        <button class="remove-account-btn"><i class="fas fa-times"></i></button>
                    </div>
                </div>
                <button class="secondary-btn" id="add-another-account-btn">
                    <i class="fas fa-plus"></i> Добавить еще аккаунт
                </button>
            </div>
            
            <div class="modal-footer">
                <button class="secondary-btn" id="cancel-add-account">Отмена</button>
                <button class="primary-btn" id="submit-add-account">Добавить</button>
            </div>
        </div>
    </div>

    <script>
        const currentUser = {{ user | tojson | safe }};
    </script>

    <!-- Подключение скриптов -->
    <script src="{{ url_for('static', path='scripts/root.js?v=0.0.5') }}"></script>
    <script src="{{ url_for('static', path='scripts/messanger.js?v=0.0.60') }}"></script>
    <script src="{{ url_for('static', path='scripts/admin-dashboard.js?v=0.0.49') }}"></script>
</body>
</html>